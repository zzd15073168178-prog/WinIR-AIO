# 🛡️ Sysinternals Tools GUI

Windows 系统监控与恶意软件分析工具 - 图形化界面

---

## 🚀 快速开始

### 推荐方式（完整功能）

```
双击: 以管理员身份启动.bat
```

### 基础功能

```
双击: 启动.bat
```

---

## ✨ 功能

| 功能 | 说明 | 权限 |
|------|------|------|
| 📊 进程列表 | 查看所有运行进程 | 普通 |
| 🌲 进程树 | 层级显示进程关系 | 普通 |
| 🌐 网络连接 | 监控网络连接 | 普通 |
| 🔍 DLL检测 | 检测DLL注入 | 管理员 |
| 🗂️ 句柄查询 | 查询进程句柄 | 管理员 |
| 💾 进程转储 | 创建内存转储 | 管理员 |
| 📊 Procmon监控 | 系统活动监控 | 管理员 |
| 🔬 动态分析 | 恶意软件行为分析 | 管理员 |

---

## 📋 系统要求

- Windows 7/8/10/11
- Python 3.7+
- psutil 库

### 安装依赖

```bash
pip install psutil
```

**可选依赖**（用于DLL详细信息）：
```bash
pip install pywin32
```
> 注：不安装pywin32也可以使用，但DLL版本信息会显示"N/A"

---

## 📁 文件结构

```
sysmon/
├── sysmon_gui_new.py          # 主程序
├── *_manager.py               # 功能模块
├── constants.py               # 配置
├── utils.py                   # 工具函数
├── *.exe                      # Sysinternals工具
├── 启动.bat                   # 启动脚本
├── 以管理员身份启动.bat       # 管理员启动
├── dumps/                     # 转储文件
├── procmon_logs/              # 监控日志
└── reports/                   # 分析报告
```

---

## 🎯 使用说明

### 进程管理
1. 查看进程列表/进程树
2. 点击"刷新"更新数据
3. 双击查看详情

### DLL检测
1. 输入进程PID
2. 点击"检测DLL"
3. 可疑DLL标红显示
4. **右键菜单功能**：
   - 📋 复制路径 - 复制DLL文件路径到剪贴板
   - 📂 打开文件位置 - 在资源管理器中定位文件
   - 🔍 查看详细信息 - 显示文件大小、版本、签名等完整信息
   - ✍️ 查看签名信息 - 验证数字签名状态
   - 📄 查看文件属性 - 打开系统属性对话框

### 句柄查询
1. 输入进程PID
2. 选择过滤类型
3. 点击"查询句柄"

### 进程转储
1. 输入进程PID
2. 选择转储类型
3. 点击"创建转储"
4. 文件保存在 `dumps/`

### 动态分析
1. 选择可疑文件
2. 点击"开始分析"
3. 等待完成
4. 生成报告

⚠️ **警告**：仅在虚拟机中分析恶意软件！

---

## ⚠️ 注意事项

### 权限
- 基础功能：普通用户
- 高级功能：需要管理员权限

### 安全
- 在虚拟机中测试恶意软件
- 不要转储系统关键进程
- 定期清理日志文件

### 性能
- Procmon监控会产生大量日志
- 进程转储可能需要较长时间

---

## 🐛 故障排除

| 问题 | 解决方案 |
|------|---------|
| 程序无法启动 | 检查Python和psutil是否安装 |
| 功能无法使用 | 以管理员身份运行 |
| 转储失败 | 检查权限和磁盘空间 |
| 分析无数据 | 确保Procmon.exe存在 |

---

## 📚 文档

- `全面功能检查报告.md` - 系统检查报告
- `requirements.txt` - 依赖列表

---

**开发**: Python + Tkinter + Sysinternals Tools
**版本**: 模块化版本
**许可**: 仅供学习研究使用

