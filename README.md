# Sysinternals 工具集 GUI

一个用于方便调用 Sysinternals 工具的图形界面程序，告别命令行输入的繁琐！

## 功能特点

✨ **现代化的图形界面** - 使用Python和tkinter构建，简洁美观  
🚀 **三大工具集成** - 整合Handle、ListDLLs和ProcDump工具  
🔍 **可视化进程浏览器** ⭐ - 实时查看所有进程，双击快速选择  
📊 **结构化视图** ⭐ NEW - 表格化展示结果，支持排序、筛选、统计  
💾 **数据导出** - 支持CSV导出，可用Excel深度分析  
📋 **智能搜索** - 实时筛选结果，快速定位目标  
🎨 **双视图模式** - 原始输出+结构化视图，自由切换  

## 支持的工具

### 0. 进程列表 ⭐ 新功能
可视化进程浏览器
- 实时显示所有运行的进程
- 显示PID、进程名、内存使用、CPU时间
- 支持搜索过滤进程
- 双击选择进程并应用到工具
- 右键菜单快速应用
- 一键刷新进程列表

### 1. Handle.exe
查看系统中打开的句柄信息
- 按进程名称或PID过滤
- 搜索特定对象
- 显示未命名句柄
- 显示所有句柄类型

### 2. Listdlls.exe
列出进程加载的DLL文件
- 按进程名称或PID查询
- 仅显示未签名的DLL
- 显示版本信息

### 3. Procdump.exe
创建进程内存转储文件
- 完整转储或迷你转储
- 异常时自动转储
- 挂起时转储
- 支持多次转储
- 压缩转储文件

## 系统要求

- Windows 10/11
- Python 3.6 或更高版本
- Sysinternals 工具（handle.exe, Listdlls.exe, procdump.exe）

## 安装与使用

### 1. 确保已安装Python

检查Python版本：
```bash
python --version
```

如未安装，请访问 [Python官网](https://www.python.org/downloads/) 下载安装。

### 2. 确保工具文件在同一目录

确保以下文件在同一文件夹中：
```
codex/
├── sysinternals_gui.py
├── handle.exe
├── Listdlls.exe
└── procdump.exe
```

### 3. 运行程序

双击运行或命令行执行：
```bash
python sysinternals_gui.py
```

## 使用说明

### 进程列表 ⭐
1. 打开程序后默认显示"进程列表"选项卡
2. 自动加载所有运行的进程
3. 使用搜索框快速过滤进程（支持按名称或PID搜索）
4. **双击**任意进程：
   - 弹出对话框选择应用到哪个工具
   - 可选择"是"应用到所有工具
5. **右键点击**进程：
   - 应用到 Handle - 快速应用到Handle工具
   - 应用到 ListDLLs - 快速应用到ListDLLs工具
   - 应用到 ProcDump - 快速应用到ProcDump工具
   - 复制 PID - 复制进程ID到剪贴板
   - 复制进程名 - 复制进程名称到剪贴板
6. 点击"🔄 刷新"按钮更新进程列表

### Handle 工具
1. 切换到 "Handle" 选项卡
2. （可选）输入进程名称或PID，如 `notepad.exe` 或 `1234`
3. （可选）输入要搜索的对象名称
4. 选择需要的选项（显示未命名句柄、显示所有类型等）
5. 点击"执行"按钮
6. 在输出区域查看结果

### ListDLLs 工具
1. 切换到 "ListDLLs" 选项卡
2. （可选）输入进程名称或PID
3. 选择需要的选项（仅显示未签名、显示版本信息等）
4. 点击"执行"按钮
5. 在输出区域查看结果

### ProcDump 工具
1. **推荐方式**：点击"📋 选择进程"按钮，从进程列表中选择（自动使用PID）
2. 或手动输入PID（推荐）或进程名称
3. 选择输出目录（默认为当前目录）
4. 选择转储类型（完整转储、迷你转储等）
5. 设置转储次数
6. （可选）勾选压缩选项
7. 点击"执行"按钮
8. 在输出区域查看进度

**重要提示**：
- ⭐ 使用PID比进程名更可靠
- ⚠️ 系统进程需要管理员权限
- 💡 从进程列表选择会自动使用PID

## 输出操作

### 原始输出视图
- **清空输出** - 清除输出区域的所有内容
- **保存输出** - 将输出结果保存为文本文件
- **复制到剪贴板** - 将输出内容复制到系统剪贴板

### 结构化视图 ⭐ NEW
- **表格展示** - 自动解析并以表格形式展示结果
- **搜索筛选** - 实时搜索过滤，支持全字段匹配
- **列排序** - 点击列标题对数据排序
- **统计信息** - 自动显示记录总数
- **导出CSV** - 将数据导出为CSV文件，可用Excel打开
- **复制选中行** - 快速复制表格中的选中行

### 适用工具
- ✅ **ListDLLs** - 完美支持，显示DLL详细信息
- ✅ **Handle** - 完美支持，显示句柄列表
- ⚪ **ProcDump** - 保持文本输出（转储进度不需要表格）

## 常见问题

### Q: ProcDump提示"Error opening process"？
A: 这通常是因为：
- **使用了进程名而不是PID** - 从进程列表选择会自动使用PID
- 权限不足 - 使用"以管理员启动.bat"运行程序
- 进程已退出 - 刷新进程列表确认进程仍在运行

### Q: 如何转储系统进程？
A: 
1. 使用"以管理员启动.bat"启动程序
2. 在进程列表中找到目标进程
3. 右键点击选择"应用到 ProcDump"
4. 程序会自动使用PID（更可靠）

### Q: 提示"找不到文件"？
A: 确保 .exe 工具文件与 Python 脚本在同一目录下。

### Q: 需要管理员权限吗？
A: 某些操作（如访问系统进程）需要管理员权限。强烈建议使用"以管理员启动.bat"运行程序。

### Q: tkinter 未安装？
A: 重新安装Python，安装时确保勾选 "tcl/tk and IDLE" 选项。

### Q: 输出乱码？
A: 程序已配置UTF-8编码，如仍有问题，请检查系统区域设置。

### Q: 为什么推荐使用PID而不是进程名？
A: 
- PID是唯一的进程标识符
- 某些系统进程无法通过名称访问
- 避免多个同名进程的歧义
- 更高的成功率和可靠性

## 注意事项

⚠️ **首次运行** - Sysinternals工具首次运行时会显示EULA协议，程序已自动接受（-accepteula参数）

⚠️ **管理员权限** - 某些操作需要管理员权限才能正常工作

⚠️ **进程转储** - ProcDump可能生成较大的文件，请确保有足够的磁盘空间

## 技术栈

- Python 3.6+
- tkinter (GUI框架)
- subprocess (进程管理)
- threading (多线程)

## 作者

开发于 2025年11月

## 许可证

本GUI工具为开源项目。Sysinternals工具归Microsoft所有，请遵守其使用条款。

## 更新日志

### v1.2.0 (2025-11-23)
- 🎨 全新结构化视图 - 表格化展示结果
- 📊 智能数据解析 - 自动提取关键信息
- 🔍 实时搜索筛选 - 快速定位目标数据
- 💾 CSV导出功能 - 支持Excel深度分析
- 📈 自动统计信息 - 显示记录总数
- 🔄 列排序功能 - 点击列标题排序
- 📋 复制选中行 - 快速复制表格数据

### v1.1.2 (2025-11-23)
- 🎯 ProcDump自动使用PID（更可靠）
- 🛡️ 智能系统进程检测和警告
- 💡 智能错误代码解释和建议
- ✨ 添加"选择进程"快捷按钮
- 📝 改进错误提示和用户引导

### v1.1.1 (2025-11-23)
- 🔧 修复tkinter Treeview错误
- 🔧 修复批处理文件编码问题
- ✅ 改进Windows兼容性

### v1.1.0 (2025-11-23)
- ⭐ 新增可视化进程列表功能
- ✅ 支持双击/右键快速选择进程
- ✅ 实时显示进程信息（PID、名称、内存、CPU时间）
- ✅ 进程搜索和过滤功能
- ✅ 一键应用进程到所有工具

### v1.0.0 (2025-11-23)
- 🎉 初始版本发布
- ✅ 支持 Handle、ListDLLs、ProcDump 三个工具
- ✅ 实时输出显示
- ✅ 结果保存和复制功能

